# AGOT KNIGHTING DECISIONS by DYLAN

agot_buy_knighthood_decision = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_recruitment.dds"
	}

	sort_order = 75

	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					faith = {
						has_doctrine = tenet_knighthood
					}
				}
				desc = agot_buy_knighthood_decision_desc
			}
			triggered_desc = {
				trigger = {
					NOT = {
						faith = {
							has_doctrine = tenet_knighthood
						}
					}
				}
				desc = agot_buy_knighthood_decision_desc_outsider
			}
			desc = agot_buy_knighthood_decision_desc
		}
	}

	ai_check_interval = 24 #AI will evaluate this every 24 months

	cost = {
		gold = {
			value = 200
			if = {
				limit = {
					highest_held_title_tier >= tier_kingdom #LP + King in Westeros
				}
				add = 200 #The higher ranked you are the more you should pay.
			}
		}
		prestige = {
			value = 200
			if = {
				limit = {
					highest_held_title_tier >= tier_kingdom #LP + King in Westeros
				}
				add = 200 #The higher ranked you are the more you should pay.
			}
		}
		piety = {
			value = 0
			if = {
				limit = {
					faith = {
						has_doctrine = tenet_knighthood
					}
				}
				add = 150
			}
			if = {
				limit = {
					highest_held_title_tier >= tier_kingdom #LP + King in Westeros
				}
				add = 200 #The higher ranked you are the more you should pay.
			}
		}
	}

	is_shown = {
		agot_can_become_a_knight_trigger = yes

		NOR = {
			has_character_flag = agot_bought_knighthood	#You have not bought knighthood before
			OR = { #Having just or content will prohibit this decision
				has_trait = just
				has_trait = content
			}
			culture = { agot_is_wildling_culture = yes }
			OR = { #If your faith has the Knighthood Tenet and You're Either Zealous/PTY Level 4; or,
				AND = {
					faith = {
						has_doctrine = tenet_knighthood
					}
					OR = {
						has_trait = zealous
						piety_level >= 4
					}
				}
			}
		}
	}

	is_valid = {
		OR = { #it is shown if you have the knighthood tenet, OR you do not have the knighthood tenet but you are ambitious.
			faith = {
				has_doctrine = tenet_knighthood
			}
			AND = { #This will show if you do not have the knighthood tenet + the ambitious trait
				NOT = {
					faith = {
						has_doctrine = tenet_knighthood
					}
				}
				has_trait = ambitious
				NOT = { has_trait = zealous }
			}
		}
	}

	is_valid_showing_failures_only  = {
		is_at_war = no
		is_imprisoned = no
		is_available_adult = yes
		NOT = { government_has_flag = government_is_tribal }
	}

	effect = {
		add_character_flag = agot_bought_knighthood
		custom_tooltip = agot_buy_knighthood_decision_tooltip
		hidden_effect = {
			agot_become_a_knight_effect = {
				KNIGHT_MAKER = root
				KNIGHT_TO_BE = root
			}
		}
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 5

		modifier = {
			add = -33
			faith = {
				has_doctrine = tenet_knighthood # If your faith has the knighthood tenet, you are less likely to do this
			}
		}
		modifier = {
			add = -75
			faith = {
				NOT = { has_doctrine = tenet_knighthood } # If your faith does not have the knighthood tenet, you are less likely to do this
			}
		}
		modifier = {
			add = -33
			ai_has_cautious_personality = yes
		}
		modifier = {
			add = 10
			ai_has_economical_boom_personality = yes
		}
		modifier = {
			add = 20
			ai_greed >= high_positive_ai_value
		}
		modifier = {
			add = 33
			has_trait = ambitious
		}
		modifier = { # If you have the Knighthood Tenet, You will be more inclined to buy knighthood if you are impatient
			add = 20
			AND = {
				has_trait = impatient
				faith = {
					has_doctrine = tenet_knighthood
				}
			}
		}
		modifier = {
			add = 20
			has_trait = deceitful
		}
		modifier = {
			add = 5
			has_trait = cynical
		}
		modifier = {
			add = 5
			has_trait = trusting
		}
		modifier = {
			add = -50
			has_trait = humble
		}
		modifier = {
			add = -50
			has_trait = content
		}
		modifier = {
			add = -50
			has_trait = paranoid
		}
		modifier = {
			add = -100 #While we support female knighting, Westeros is still a patriarchal society.
			is_male = no
		}

	}
}